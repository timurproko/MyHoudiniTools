<?xml version="1.0" encoding="UTF-8"?>
<menuDocument>
    <menu>

<subMenu id = "ctrl_menu">
<insertBefore>channels_menu</insertBefore>
<label>Parameters Control</label>
<expression>
<![CDATA[
if hou.getenv("CTRL_NODE"):
    return True
else:
    return False
]]>
</expression>
<scriptItem id = "ctrl_parm_spare">
<label>Set as Spare Parameter</label>
<expression>
<![CDATA[
import hou
node = hou.selectedNodes()
node = node[0]
if node.type().name() == "null":
    return False
else:
    return True
]]>
</expression>
<scriptCode>
<![CDATA[
def runLater():
    import parms
    parms.parmUtils(kwargs).createRelativeReference(assign_to_definition=False)
import hdefereval
hdefereval.executeDeferred(runLater)
]]>
</scriptCode>
</scriptItem>

<scriptItem id = "ctrl_parm_remove">
<label>Remove Spare Parameter</label>
<insertAfter>ctrl_parm_spare</insertAfter>
<expression>
<![CDATA[
import hou
node = hou.selectedNodes()
node = node[0]
if node.type().name() != "null":
    return False
else: 
    return True

if not isinstance(kwargs["parms"][0].parmTemplate(), hou.FolderSetParmTemplate):
    return True
else:
    return False
]]>
</expression>
<scriptCode>
<![CDATA[
def runLater():
    import parms
    parms.parmUtils(kwargs).deleteParm()
import hdefereval
hdefereval.executeDeferred(runLater)
]]>             
</scriptCode>
</scriptItem>

<scriptItem id = "ctrl_referencing">
<label>Jump to Reference Node</label>
<insertAfter>ctrl_parm_remove</insertAfter>
<expression>
<![CDATA[
if kwargs["parms"][0].parmsReferencingThis():
    return True
return False
]]>
</expression>
<scriptCode>
<![CDATA[
def runLater():
    import parms
    ref_node = kwargs["parms"][0].parmsReferencingThis()[-1].node()
    network_editor = hou.ui.paneTabOfType(hou.paneTabType.NetworkEditor)
    if network_editor:
        network_editor.setCurrentNode(ref_node)
        if kwargs["ctrlclick"]:
            network_editor.homeToSelection()
        if kwargs["altclick"]:
            ref_node.setGenericFlag(hou.nodeFlag.Display, 1)
import hdefereval
hdefereval.executeDeferred(runLater)
]]>            
</scriptCode>
</scriptItem>
        </subMenu>

        <subMenu id="expression_menu">
        <label>Expression</label>
<addScriptItem id="open_vsc">
<label>Edit in External Editor Embedded</label>
<parent>expression_menu</parent>
<insertAtIndex>3</insertAtIndex>
<context>
<expression>
<![CDATA[
try:
    from HoudiniExprEditor import ParmWatcher
    return ParmWatcher.is_valid_parm(kwargs["parms"][0])
except:
    return False
]]>
</expression>
</context>
<scriptCode>
<![CDATA[
from nodes.scripts import vex_wrangle
vex_wrangle.vscEmbed(kwargs["parms"][0], 'Visual Studio Code')
]]>
</scriptCode>
</addScriptItem>
        </subMenu>
        </menu>
</menuDocument>